/*! openkarotz-js v0.3.0 | (c) 2013 Olivier Bagot | opensource.org/licenses/MIT
 * http://github.com/hobbe/openkarotz-js
 */
"use strict";var OpenKarotz=function(e){if(e===undefined){console.log("variable karotz_ip is required!");throw new Error("variable karotz_ip is required!")}this.WHITE="FFFFFF";this.BLACK="000000";this.RED="FF0000";this.GREEN="00FF00";this.BLUE="0000FF";this.VIOLET="660099";this.CYAN="00FFFF";this.YELLOW="FFFF00";this.PINK="FF00CB";this.ORANGE="FF9900";this.ip=e;this.state={sleep:1,version:"unknown",karotz_free_space:"unknown"};var t="http://"+e;var n=t+"/cgi-bin";var r=n+"/status";var i=n+"/sleep";var s=n+"/wakeup";var o=n+"/reboot";var u=n+"/sound";var a=n+"/sound_control";var f=n+"/leds";var l=n+"/ears";var c=n+"/ears_reset";var h=n+"/ears_random";var p=n+"/tts";var d=n+"/snapshot";var v=n+"/snapshot_get";var m=n+"/apps/moods";this.getIp=function(){return this.ip};this.getUrl=function(){return t};this.getApiUrl=function(){return n};this.getState=function(){return this.state};this.status=function(e,t){console.log("status: "+r);var n=this;$.get(r,function(r){console.log("status: "+r);if(r){var i=JSON.parse(r);n.state=i;console.log(n.state);if(e){e(i)}}else{n.state.sleep=1;if(t){t("rabbit is offline")}}})};this.sleep=function(e,t){var n=this;$.get(i,function(r){console.log("sleep: "+r);var i=JSON.parse(r);if(i.return==0){n.state.sleep=1;if(e){e(i)}}else{if(t){t(i.msg)}}})};this.wakeup=function(e,t){var n=this;$.get(s+"?silent=1",function(r){console.log("wakeup: "+r);var i=JSON.parse(r);if(i.return==0){n.state.sleep=0;if(e){e(i)}}else{if(t){t(i.msg)}}})};this.reboot=function(e,t){$.get(o,function(n){console.log("reboot: "+n);var r=JSON.parse(n);if(r.return==0){if(e){e(r)}}else{if(t){t(r.msg)}}})};this.sound=function(e,t,n){$.get(u+"?url="+e,function(e){console.log("sound: "+e);var r=JSON.parse(e);if(r.return==0){if(t){t(r)}}else{if(n){n(r.msg)}}})};this.soundInternal=function(e,t,n){$.get(u+"?id="+e,function(r){console.log("sound id "+e+": "+r);var i=JSON.parse(r);if(i.return==0){if(t){t(i)}}else{if(n){n(i.msg)}}})};this.soundControl=function(e,t,n){$.get(a+"?cmd="+e,function(r){console.log("sound_control("+e+"): "+r);var i=JSON.parse(r);if(i.return==0){if(t){t(i)}}else{if(n){n(i.msg)}}})};this.soundControlPause=function(e,t){this.soundControl("pause",e,t)};this.soundControlQuit=function(e,t){this.soundControl("quit",e,t)};this.leds=function(e,t,n,r){var i="?";if(t&&t==true){i+="pulse=1&"}$.get(f+i+"color="+e,function(e){console.log("leds: "+e);var t=JSON.parse(e);if(t.return==0){if(n){n(t)}}else{if(r){r(t.msg)}}})};this.ledsPulse=function(e,t,n){this.leds(e,true,t,n)};this.ledsFixed=function(e,t,n){this.leds(e,false,t,n)};this.ears=function(e,t,n,r){$.get(l+"?left="+e+"&right="+t,function(e){console.log("ears: "+e);var t=JSON.parse(e);if(t.return==0){if(n){n(t)}}else{if(r){r(t.msg)}}})};this.earsReset=function(e,t){$.get(c,function(n){console.log("ears_reset: "+n);var r=JSON.parse(n);if(r.return==0){if(e){e(r)}}else{if(t){t(r.msg)}}})};this.earsRandom=function(e,t){$.get(h,function(n){console.log("ears_random: "+n);var r=JSON.parse(n);if(r.return==0){if(e){e(r)}}else{if(t){t(r.msg)}}})};this.moods=function(e,t,n){var r="";if(e){r+="?id="+e}$.get(m+r,function(e){console.log("moods: "+e);var r=JSON.parse(e);if(r.return==0){if(t){t(r)}}else{if(n){n(r.msg)}}})};this.tts=function(e,t,n,r,i){var s='?text="Bonjour"';if(e){s='?text="'+encodeURIComponent(e.replace(new RegExp("'","g"),""))+'"'}var o="&voice=margaux";if(t){o="&voice="+encodeURIComponent(t)}var u="&nocache=0";if(n&&n==true){u="&nocache=1"}var a=p+s+o+u;console.log("tts: "+a);$.get(a,function(e){console.log("tts: "+e);var t=JSON.parse(e);if(t.return==0){if(r){r(t)}}else{if(i){i(t.msg)}}})};this.snapshot=function(e,t,n){var r="?silent=0";if(e&&e==true){r="?silent=1"}var i=d+r;console.log("silent: "+i);$.get(i,function(e){console.log("silent: "+e);var r=JSON.parse(e);if(r.return==0){if(t){t(r)}}else{if(n){n(r.msg)}}})};this.getSnapshotUrl=function(e){var t=v+"?filename="+e;console.log("getSnapshotUrl: "+t);return t};return this}